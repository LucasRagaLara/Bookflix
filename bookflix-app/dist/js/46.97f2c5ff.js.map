{"version":3,"file":"js/46.97f2c5ff.js","mappings":"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","sources":["webpack://bookflix-app/./src/views/EditarPerfilView.vue","webpack://bookflix-app/./src/views/EditarPerfilView.vue?d82e"],"sourcesContent":["<template>\r\n    <div class=\"home w-full min-h-screen items-center flex flex-col xl:pt-28\">\r\n\r\n        <div class=\"flex items-center justify-center w-[50%] mx-auto h-[60vh] gap-x-40 flex-col\">\r\n\r\n            <form class=\"w-full flex flex-col\">\r\n\r\n                <div class=\"mb-10 flex items-center justify-center\">\r\n                    <h1 class=\"text-4xl flex items-start justify-start mt-5 font-bold \">{{ perfilEditando ? 'Editar perfil' : 'Crear nuevo perfil' }}</h1>\r\n                </div>\r\n\r\n                <div class=\"w-full flex items-center justify-center gap-x-10 mb-20\">\r\n                    <div class=\"border border-red-900 h-[15rem] w-[35%] rounded-lg flex-col flex pt-10 pl-10\">\r\n                        <label for=\"Nombre\" class=\"font-bold mb-4\">Elige tu nombre</label>\r\n                        <input type=\"text\" class=\"bg-[#802C32] rounded-lg outline-none placeholder:text-[#c1c1c1] border-none pl-4 p-1 w-[80%]\" placeholder=\"Nombre\" v-model=\"nombre\">\r\n                    </div>\r\n\r\n                    <div class=\"w-[20%] flex items-center justify-center relative\">\r\n                        <img :src=\"Object.keys(perfilEditando).length === 0 ? nuevoPerfil.imagen : perfilEditando.imagen\" alt=\"\" ref=\"imagenSeleccionada\">\r\n                        <div class=\"w-[3.5rem] h-[3.5rem] items-center justify-center bg-[#C12C38] flex absolute bottom-0 right-7 rounded-full p-2 cursor-pointer transition-all duration-300 ease-in-out transform hover:scale-110 hover:text-[#c12c38] hover:bg-[#f1f1f1] text-[#f1f1f1]\">\r\n                            <i class=\"fa-solid fa-pencil text-3xl\" @click=\"seleccionarImagen()\"></i>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"flex items-center justify-center w-full gap-x-10\">\r\n                    <div class=\"flex items-center justify-center\">\r\n                    <button type=\"button\" class=\"bg-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12\" @click=\"cancelarEdicionPerfiles\">VOLVER</button>\r\n                    </div>\r\n                    <div class=\"flex items-center justify-center\">\r\n                        <button type=\"button\" class=\"border-2 border-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110\" @click=\"borrarPerfil\">BORRAR PERFIL</button>\r\n                    </div>\r\n                </div>\r\n\r\n            </form>\r\n\r\n        <div class=\"absolute top-10 right-20 flex flex-col items-end justify-end w-full\">\r\n            <button type=\"button\" class=\"bg-[#C12C38] py-2 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12\" @click=\"listo\">LISTO</button>\r\n        </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</template>\r\n\r\n\r\n<script>\r\nimport {mapState, mapActions, mapMutations} from 'vuex';\r\nimport axios from 'axios';\r\nimport Swal from 'sweetalert2';\r\n    export default{\r\n        data(){\r\n            return{\r\n                nombre: '',\r\n                imagenSeleccionada: null,\r\n            }\r\n        },\r\n        mounted(){\r\n            const storedNombre = localStorage.getItem('nombrePerfilEditando');\r\n            if (storedNombre) {\r\n                this.nombre = storedNombre;\r\n            } else {\r\n                this.nombre = Object.keys(this.perfilEditando).length === 0 ? this.nuevoPerfil.nombre : this.perfilEditando.nombre;\r\n            }\r\n            const obtenerPerfilEditando = localStorage.getItem('perfilEditando'); \r\n\r\n\r\n            if (obtenerPerfilEditando && JSON.parse(obtenerPerfilEditando).id) {\r\n                this.$store.commit('GUARDAR_PERFIL_EDITANDO', JSON.parse(obtenerPerfilEditando));\r\n            }\r\n\r\n            const lista_perfiles = localStorage.getItem('lista_perfiles');\r\n            if (lista_perfiles) {\r\n                this.$store.commit('SET_PERFILES', JSON.parse(lista_perfiles))\r\n            }\r\n            const imagenes = localStorage.getItem('imagenes');\r\n            if (imagenes) {\r\n                this.$store.commit('SET_IMAGENES_PERFILES', JSON.parse(imagenes))\r\n            }\r\n            const nuevoPerfil = localStorage.getItem('nuevoPerfil');\r\n            if (nuevoPerfil){\r\n                console.log(nuevoPerfil)\r\n                this.$store.commit('INICIALIZAR_PERFIL', JSON.parse(nuevoPerfil))  \r\n            }\r\n\r\n            const cargarDatos = async () => {\r\n                const idUsuario = this.$route.params.id\r\n                const comprobarPerfil = this.perfiles.find(usuario => usuario.id == idUsuario);\r\n                console.log(\"tras recorrer en busca de si lo tiene un usuario asignado\", comprobarPerfil)\r\n                console.log(\"\")\r\n                if (comprobarPerfil !== undefined){\r\n                    console.log(\"Estoy editando un perfil\")\r\n                    console.log(\"Esto lo que me da los perfiles\", comprobarPerfil)\r\n                }else if(this.nuevoPerfil == false){\r\n                    console.log(\"Si es false, es que no se ha creado y se crea\")\r\n                    this.crearPerfil()\r\n                }\r\n            };\r\n            cargarDatos();\r\n        },\r\n\r\n        computed:{\r\n            ...mapState(['perfilEditando', 'imagenes_perfiles', 'nuevoPerfil', 'perfiles'])\r\n        },\r\n        methods:{\r\n            ...mapMutations(['RESETEAR_EDICION']),\r\n            ...mapActions(['crearPerfil']),\r\n            async listo(){\r\n\r\n                if (!this.nombre || this.nombre.length < 3) {\r\n                    Swal.fire({\r\n                        icon: 'error',\r\n                        title: 'Oops...',\r\n                        text: 'El nombre debe tener al menos 3 caracteres',\r\n                    });\r\n                    return;\r\n                }\r\n                const id = localStorage.getItem('userId')\r\n                this.imagenSeleccionada = this.$refs.imagenSeleccionada.src;\r\n                if (Object.keys(this.perfilEditando).length !== 0) {\r\n                    // Editar perfil existente\r\n                    try {\r\n                        console.log(this.nombre, this.imagenSeleccionada)\r\n                        const editarPerfil = await axios.put(`/api/perfiles/editar/${this.$route.params.id}`, {\r\n                            nombre: this.nombre,\r\n                            imagen: this.imagenSeleccionada\r\n                        });\r\n                        // Manejar la respuesta según corresponda\r\n                        if (editarPerfil.data.success) {\r\n                            // El perfil se editó correctamente\r\n                            this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                        } else {\r\n                            // Mostrar mensaje de error si falla la edición\r\n                            Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'No se pudo editar el perfil',\r\n                            });\r\n                        }\r\n                    } catch (error) {\r\n                        // Manejar errores de la solicitud\r\n                        console.error(\"Hubo un error al editar el perfil\", error)\r\n                    }\r\n                } else {\r\n                // Aquí debería agregar el perfil a la base de datos. Con el nombre que el usuario haya introducido y con la imagen correspondiente.\r\n                    try{\r\n                        const agregarPerfil = await axios.post('/api/perfiles/agregar', {\r\n                            id_usuario: id,\r\n                            id_perfil: this.$route.params.id,\r\n                            nombre: this.nombre,\r\n                            imagen: this.imagenSeleccionada\r\n                        });\r\n                        console.log(agregarPerfil)\r\n                        if (agregarPerfil.data.success) {\r\n                            // El perfil se agregó correctamente\r\n                            this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                        }else{\r\n                            Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'El perfil ya existe en la base de datos',\r\n                            });\r\n                        }\r\n                    }catch(error){\r\n                        console.log(\"Hubo un error al agregar el perfil\", error)\r\n                    }\r\n                }\r\n            },\r\n            seleccionarImagen(){\r\n                localStorage.setItem('nombrePerfilEditando', this.nombre);\r\n                this.$router.push({name: 'cambiar-imagen', params: {id: this.$route.params.id}})\r\n            },\r\n            cancelarEdicionPerfiles(){\r\n                const id = localStorage.getItem('userId')\r\n                localStorage.removeItem('nombrePerfilEditando');\r\n                this.$router.push({ name: 'Perfil', params: { id: id} });\r\n            },\r\n            borrarPerfil(){\r\n                const id = localStorage.getItem('userId')\r\n                localStorage.removeItem('nombrePerfilEditando');\r\n                Swal.fire({\r\n                    title: 'Vas a borrar el perfil ¿Deseas continuar?',\r\n                    text: \"Esta acción no se puede deshacer.\",\r\n                    icon: 'warning',\r\n                    showCancelButton: true,\r\n                    confirmButtonColor: '#C12C38',\r\n                    cancelButtonColor: '#d33',\r\n                    confirmButtonText: 'Sí, borrar',\r\n                    cancelButtonText: 'Cancelar'\r\n                }).then(async (result) => {\r\n                    if (result.isConfirmed) {\r\n                        try {\r\n                            const borrar_perfil = await axios.delete(`/api/perfiles/eliminar/${this.$route.params.id}`);\r\n                            if (borrar_perfil.data.success){\r\n                                this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                            }else{\r\n                                Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'No se ha podido borrar el perfil',\r\n                            });\r\n                            }\r\n                        }catch(error){\r\n                            console.log(error)\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n        },\r\n        created() {\r\n            \r\n    }\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.home{\r\n    background: url('../assets/backgrounds/editar_perfil.png');\r\n    background-repeat: no-repeat;\r\n    background-size: 100% 100vh;\r\n}\r\n\r\n</style>","import { render } from \"./EditarPerfilView.vue?vue&type=template&id=955b470a&scoped=true\"\nimport script from \"./EditarPerfilView.vue?vue&type=script&lang=js\"\nexport * from \"./EditarPerfilView.vue?vue&type=script&lang=js\"\n\nimport \"./EditarPerfilView.vue?vue&type=style&index=0&id=955b470a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-955b470a\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","_ctx","perfilEditando","_hoisted_6","_hoisted_7","_hoisted_8","type","placeholder","_cache","$event","$data","nombre","_hoisted_9","src","Object","keys","length","nuevoPerfil","imagen","alt","ref","_hoisted_10","_hoisted_11","onClick","$options","seleccionarImagen","_hoisted_12","_hoisted_13","args","cancelarEdicionPerfiles","_hoisted_14","borrarPerfil","_hoisted_15","listo","data","imagenSeleccionada","mounted","storedNombre","localStorage","getItem","this","obtenerPerfilEditando","JSON","parse","id","$store","commit","lista_perfiles","imagenes","console","log","cargarDatos","async","idUsuario","$route","params","comprobarPerfil","perfiles","find","usuario","undefined","crearPerfil","computed","mapState","methods","mapMutations","mapActions","Swal","icon","title","text","$refs","editarPerfil","axios","put","success","$router","push","name","error","agregarPerfil","post","id_usuario","id_perfil","setItem","removeItem","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","isConfirmed","borrar_perfil","delete","created","__exports__","render"],"sourceRoot":""}