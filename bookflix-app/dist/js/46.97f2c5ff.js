"use strict";(self["webpackChunkbookflix_app"]=self["webpackChunkbookflix_app"]||[]).push([[46],{3046:function(e,t,r){r.r(t),r.d(t,{default:function(){return $}});var o=r(6768),i=r(4232),a=r(5130);const s=e=>((0,o.Qi)("data-v-955b470a"),e=e(),(0,o.jt)(),e),l={class:"home w-full min-h-screen items-center flex flex-col xl:pt-28"},n={class:"flex items-center justify-center w-[50%] mx-auto h-[60vh] gap-x-40 flex-col"},c={class:"w-full flex flex-col"},d={class:"mb-10 flex items-center justify-center"},f={class:"text-4xl flex items-start justify-start mt-5 font-bold"},m={class:"w-full flex items-center justify-center gap-x-10 mb-20"},u={class:"border border-red-900 h-[15rem] w-[35%] rounded-lg flex-col flex pt-10 pl-10"},p=s((()=>(0,o.Lk)("label",{for:"Nombre",class:"font-bold mb-4"},"Elige tu nombre",-1))),g={class:"w-[20%] flex items-center justify-center relative"},h=["src"],b={class:"w-[3.5rem] h-[3.5rem] items-center justify-center bg-[#C12C38] flex absolute bottom-0 right-7 rounded-full p-2 cursor-pointer transition-all duration-300 ease-in-out transform hover:scale-110 hover:text-[#c12c38] hover:bg-[#f1f1f1] text-[#f1f1f1]"},x={class:"flex items-center justify-center w-full gap-x-10"},E={class:"flex items-center justify-center"},v={class:"flex items-center justify-center"},k={class:"absolute top-10 right-20 flex flex-col items-end justify-end w-full"};function S(e,t,r,s,S,y){return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",n,[(0,o.Lk)("form",c,[(0,o.Lk)("div",d,[(0,o.Lk)("h1",f,(0,i.v_)(e.perfilEditando?"Editar perfil":"Crear nuevo perfil"),1)]),(0,o.Lk)("div",m,[(0,o.Lk)("div",u,[p,(0,o.bo)((0,o.Lk)("input",{type:"text",class:"bg-[#802C32] rounded-lg outline-none placeholder:text-[#c1c1c1] border-none pl-4 p-1 w-[80%]",placeholder:"Nombre","onUpdate:modelValue":t[0]||(t[0]=e=>S.nombre=e)},null,512),[[a.Jo,S.nombre]])]),(0,o.Lk)("div",g,[(0,o.Lk)("img",{src:0===Object.keys(e.perfilEditando).length?e.nuevoPerfil.imagen:e.perfilEditando.imagen,alt:"",ref:"imagenSeleccionada"},null,8,h),(0,o.Lk)("div",b,[(0,o.Lk)("i",{class:"fa-solid fa-pencil text-3xl",onClick:t[1]||(t[1]=e=>y.seleccionarImagen())})])])]),(0,o.Lk)("div",x,[(0,o.Lk)("div",E,[(0,o.Lk)("button",{type:"button",class:"bg-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12",onClick:t[2]||(t[2]=(...e)=>y.cancelarEdicionPerfiles&&y.cancelarEdicionPerfiles(...e))},"VOLVER")]),(0,o.Lk)("div",v,[(0,o.Lk)("button",{type:"button",class:"border-2 border-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110",onClick:t[3]||(t[3]=(...e)=>y.borrarPerfil&&y.borrarPerfil(...e))},"BORRAR PERFIL")])])]),(0,o.Lk)("div",k,[(0,o.Lk)("button",{type:"button",class:"bg-[#C12C38] py-2 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12",onClick:t[4]||(t[4]=(...e)=>y.listo&&y.listo(...e))},"LISTO")])])])}var y=r(782),I=r(4373),L=r(4874),P=r.n(L),C={data(){return{nombre:"",imagenSeleccionada:null}},mounted(){const e=localStorage.getItem("nombrePerfilEditando");this.nombre=e||(0===Object.keys(this.perfilEditando).length?this.nuevoPerfil.nombre:this.perfilEditando.nombre);const t=localStorage.getItem("perfilEditando");t&&JSON.parse(t).id&&this.$store.commit("GUARDAR_PERFIL_EDITANDO",JSON.parse(t));const r=localStorage.getItem("lista_perfiles");r&&this.$store.commit("SET_PERFILES",JSON.parse(r));const o=localStorage.getItem("imagenes");o&&this.$store.commit("SET_IMAGENES_PERFILES",JSON.parse(o));const i=localStorage.getItem("nuevoPerfil");i&&(console.log(i),this.$store.commit("INICIALIZAR_PERFIL",JSON.parse(i)));const a=async()=>{const e=this.$route.params.id,t=this.perfiles.find((t=>t.id==e));console.log("tras recorrer en busca de si lo tiene un usuario asignado",t),console.log(""),void 0!==t?(console.log("Estoy editando un perfil"),console.log("Esto lo que me da los perfiles",t)):0==this.nuevoPerfil&&(console.log("Si es false, es que no se ha creado y se crea"),this.crearPerfil())};a()},computed:{...(0,y.aH)(["perfilEditando","imagenes_perfiles","nuevoPerfil","perfiles"])},methods:{...(0,y.PY)(["RESETEAR_EDICION"]),...(0,y.i0)(["crearPerfil"]),async listo(){if(!this.nombre||this.nombre.length<3)return void P().fire({icon:"error",title:"Oops...",text:"El nombre debe tener al menos 3 caracteres"});const e=localStorage.getItem("userId");if(this.imagenSeleccionada=this.$refs.imagenSeleccionada.src,0!==Object.keys(this.perfilEditando).length)try{console.log(this.nombre,this.imagenSeleccionada);const t=await I.A.put(`/api/perfiles/editar/${this.$route.params.id}`,{nombre:this.nombre,imagen:this.imagenSeleccionada});t.data.success?this.$router.push({name:"Perfil",params:{id:e}}):P().fire({icon:"error",title:"Oops...",text:"No se pudo editar el perfil"})}catch(t){console.error("Hubo un error al editar el perfil",t)}else try{const t=await I.A.post("/api/perfiles/agregar",{id_usuario:e,id_perfil:this.$route.params.id,nombre:this.nombre,imagen:this.imagenSeleccionada});console.log(t),t.data.success?this.$router.push({name:"Perfil",params:{id:e}}):P().fire({icon:"error",title:"Oops...",text:"El perfil ya existe en la base de datos"})}catch(t){console.log("Hubo un error al agregar el perfil",t)}},seleccionarImagen(){localStorage.setItem("nombrePerfilEditando",this.nombre),this.$router.push({name:"cambiar-imagen",params:{id:this.$route.params.id}})},cancelarEdicionPerfiles(){const e=localStorage.getItem("userId");localStorage.removeItem("nombrePerfilEditando"),this.$router.push({name:"Perfil",params:{id:e}})},borrarPerfil(){const e=localStorage.getItem("userId");localStorage.removeItem("nombrePerfilEditando"),P().fire({title:"Vas a borrar el perfil ¿Deseas continuar?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#C12C38",cancelButtonColor:"#d33",confirmButtonText:"Sí, borrar",cancelButtonText:"Cancelar"}).then((async t=>{if(t.isConfirmed)try{const t=await I.A.delete(`/api/perfiles/eliminar/${this.$route.params.id}`);t.data.success?this.$router.push({name:"Perfil",params:{id:e}}):P().fire({icon:"error",title:"Oops...",text:"No se ha podido borrar el perfil"})}catch(r){console.log(r)}}))}},created(){}},w=r(1241);const O=(0,w.A)(C,[["render",S],["__scopeId","data-v-955b470a"]]);var $=O}}]);
//# sourceMappingURL=46.97f2c5ff.js.map