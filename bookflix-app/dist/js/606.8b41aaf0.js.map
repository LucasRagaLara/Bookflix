{"version":3,"file":"js/606.8b41aaf0.js","mappings":"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","sources":["webpack://bookflix-app/./src/views/EditarPerfilView.vue","webpack://bookflix-app/./src/views/EditarPerfilView.vue?d82e"],"sourcesContent":["<template>\r\n    <div class=\"home w-full min-h-screen items-center flex flex-col xl:pt-28 pt-[15rem]\">\r\n\r\n        <div class=\"flex items-center justify-center lg:w-[50%] w-full mx-auto h-[60vh] gap-x-40 flex-col\">\r\n\r\n            <form class=\"w-full flex flex-col\">\r\n\r\n                <div class=\"mb-10 flex items-center justify-center\">\r\n                    <h1 class=\"text-4xl flex items-start justify-start mt-5 font-bold \">{{ perfilEditando ? 'Editar perfil' : 'Crear nuevo perfil' }}</h1>\r\n                </div>\r\n\r\n                <div class=\"w-full flex lg:flex-row flex-col items-center justify-center gap-x-10 mb-20\">\r\n                    <div class=\"border border-red-900 h-[15rem] lg:w-[35%] w-[75%] lg:mx-0 mx-auto rounded-lg flex-col flex pt-10 pl-10 lg:mb-0 mb-10\">\r\n                        <label for=\"Nombre\" class=\"font-bold mb-4\">Elige tu nombre</label>\r\n                        <input type=\"text\" class=\"bg-[#802C32] rounded-lg outline-none placeholder:text-[#c1c1c1] border-none pl-4 p-1 w-[80%]\" placeholder=\"Nombre\" v-model=\"nombre\" maxlength=\"20\">\r\n                    </div>\r\n\r\n                    <div class=\"lg:w-[20%] w-[60%] flex items-center justify-center relative\">\r\n                        <img :src=\"Object.keys(perfilEditando).length === 0 ? nuevoPerfil.imagen : perfilEditando.imagen\" alt=\"\" ref=\"imagenSeleccionada\">\r\n                        <div class=\"w-[3.5rem] h-[3.5rem] items-center justify-center bg-[#C12C38] flex absolute bottom-0 right-7 rounded-full p-2 cursor-pointer transition-all duration-300 ease-in-out transform hover:scale-110 hover:text-[#c12c38] hover:bg-[#f1f1f1] text-[#f1f1f1]\">\r\n                            <i class=\"fa-solid fa-pencil text-3xl\" @click=\"seleccionarImagen()\"></i>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"flex items-center justify-center lg:w-full gap-x-10 w-[90%] mx-auto\">\r\n                    <div class=\"flex items-center justify-center\">\r\n                    <button type=\"button\" class=\"bg-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12 lg:text-xl text-sm mx-auto lg:mx-0\" @click=\"cancelarEdicionPerfiles\">VOLVER</button>\r\n                    </div>\r\n                    <div class=\"flex items-center justify-center\">\r\n                        <button type=\"button\" class=\"border-2 border-[#C12C38] py-3 px-5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 lg:text-xl text-sm mx-auto lg:mx-0\" @click=\"borrarPerfil\">BORRAR PERFIL</button>\r\n                    </div>\r\n                </div>\r\n\r\n            </form>\r\n\r\n        <div class=\"absolute lg:top-10 lg:right-20 top-5 right-5 flex flex-col items-end justify-end w-full\">\r\n            <button type=\"button\" class=\"bg-[#C12C38] py-2 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-110 items-center justify-center flex px-12\" @click=\"listo\">LISTO</button>\r\n        </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</template>\r\n\r\n\r\n<script>\r\nimport {mapState, mapActions, mapMutations} from 'vuex';\r\nimport axios from 'axios';\r\nimport Swal from 'sweetalert2';\r\n    export default{\r\n        data(){\r\n            return{\r\n                nombre: '',\r\n                imagenSeleccionada: null,\r\n            }\r\n        },\r\n        mounted(){\r\n            const storedNombre = localStorage.getItem('nombrePerfilEditando');\r\n            if (storedNombre) {\r\n                this.nombre = storedNombre;\r\n            } else {\r\n                this.nombre = Object.keys(this.perfilEditando).length === 0 ? this.nuevoPerfil.nombre : this.perfilEditando.nombre;\r\n                if (this.nombre == undefined){\r\n                    this.nombre = '';\r\n                }\r\n            }\r\n            const obtenerPerfilEditando = localStorage.getItem('perfilEditando'); \r\n\r\n\r\n            if (obtenerPerfilEditando && JSON.parse(obtenerPerfilEditando).id) {\r\n                this.$store.commit('GUARDAR_PERFIL_EDITANDO', JSON.parse(obtenerPerfilEditando));\r\n            }\r\n\r\n            const lista_perfiles = localStorage.getItem('lista_perfiles');\r\n            if (lista_perfiles) {\r\n                this.$store.commit('SET_PERFILES', JSON.parse(lista_perfiles))\r\n            }\r\n            const imagenes = localStorage.getItem('imagenes');\r\n            if (imagenes) {\r\n                this.$store.commit('SET_IMAGENES_PERFILES', JSON.parse(imagenes))\r\n            }\r\n            const nuevoPerfil = localStorage.getItem('nuevoPerfil');\r\n            if (nuevoPerfil){\r\n                console.log(nuevoPerfil)\r\n                this.$store.commit('INICIALIZAR_PERFIL', JSON.parse(nuevoPerfil))  \r\n            }\r\n\r\n            const cargarDatos = async () => {\r\n                const idUsuario = this.$route.params.id\r\n                const comprobarPerfil = this.perfiles.find(usuario => usuario.id == idUsuario);\r\n                if (comprobarPerfil !== undefined){\r\n                    console.log(\"Estoy editando un perfil\")\r\n                }else if(this.nuevoPerfil == false){\r\n                    console.log(\"Si es false, es que no se ha creado y se crea\");\r\n                    this.crearPerfil();\r\n                }\r\n            };\r\n            cargarDatos();\r\n        },\r\n\r\n        computed:{\r\n            ...mapState(['perfilEditando', 'imagenes_perfiles', 'nuevoPerfil', 'perfiles'])\r\n        },\r\n        methods:{\r\n            ...mapMutations(['RESETEAR_EDICION', 'RESETEAR_NUEVO_PERFIL', 'RESETEAR_NOMBRE_PERFIL']),\r\n            ...mapActions(['crearPerfil']),\r\n            async listo(){\r\n\r\n                if (!this.nombre || this.nombre.length < 3 || this.nombre.length >= 20) {\r\n                    Swal.fire({\r\n                        icon: 'error',\r\n                        title: 'Oops...',\r\n                        text: 'El nombre debe estar entre 3 y 20 caracteres',\r\n                    });\r\n                    return;\r\n                } \r\n                const id = localStorage.getItem('userId')\r\n                this.imagenSeleccionada = this.$refs.imagenSeleccionada.src;\r\n                if (Object.keys(this.perfilEditando).length !== 0) {\r\n                    // Editar perfil existente\r\n                    try {\r\n                        const editarPerfil = await axios.put(`/api/perfiles/editar/${this.$route.params.id}`, {\r\n                            nombre: this.nombre,\r\n                            imagen: this.imagenSeleccionada\r\n                        });\r\n                        // Manejar la respuesta según corresponda\r\n                        if (editarPerfil.data.success) {\r\n                            // El perfil se editó correctamente\r\n                            this.RESETEAR_EDICION();\r\n                            this.RESETEAR_NOMBRE_PERFIL();\r\n                            this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                        } else {\r\n                            // Mostrar mensaje de error si falla la edición\r\n                            Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'No se pudo editar el perfil',\r\n                            });\r\n                        }\r\n                    } catch (error) {\r\n                        // Manejar errores de la solicitud\r\n                        console.error(\"Hubo un error al editar el perfil\", error)\r\n                    }\r\n                } else {\r\n                // Aquí debería agregar el perfil a la base de datos. Con el nombre que el usuario haya introducido y con la imagen correspondiente.\r\n                    try{\r\n                        const agregarPerfil = await axios.post('/api/perfiles/agregar', {\r\n                            id_usuario: id,\r\n                            id_perfil: this.$route.params.id,\r\n                            nombre: this.nombre,\r\n                            imagen: this.imagenSeleccionada\r\n                        });\r\n                        if (agregarPerfil.data.success) {\r\n                            // El perfil se agregó correctamente\r\n                            this.RESETEAR_NUEVO_PERFIL();\r\n                            this.RESETEAR_NOMBRE_PERFIL();\r\n                            this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                        }else{\r\n                            Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'El perfil ya existe en la base de datos',\r\n                            });\r\n                        }\r\n                    }catch(error){\r\n                        console.log(\"Hubo un error al agregar el perfil\", error)\r\n                    }\r\n                }\r\n            },\r\n            seleccionarImagen(){\r\n                localStorage.setItem('nombrePerfilEditando', this.nombre !== undefined ? this.nombre : '');\r\n                this.$router.push({name: 'cambiar-imagen', params: {id: this.$route.params.id}})\r\n            },\r\n            cancelarEdicionPerfiles(){\r\n                this.RESETEAR_NUEVO_PERFIL();\r\n                this.RESETEAR_NOMBRE_PERFIL();\r\n                const id = localStorage.getItem('userId')\r\n                localStorage.removeItem('nombrePerfilEditando');\r\n                this.$router.push({ name: 'Perfil', params: { id: id} });\r\n            },\r\n            borrarPerfil(){\r\n                const id = localStorage.getItem('userId')\r\n                localStorage.removeItem('nombrePerfilEditando');\r\n                Swal.fire({\r\n                    title: 'Vas a borrar el perfil ¿Deseas continuar?',\r\n                    text: \"Esta acción no se puede deshacer.\",\r\n                    icon: 'warning',\r\n                    showCancelButton: true,\r\n                    confirmButtonColor: '#C12C38',\r\n                    cancelButtonColor: '#d33',\r\n                    confirmButtonText: 'Sí, borrar',\r\n                    cancelButtonText: 'Cancelar'\r\n                }).then(async (result) => {\r\n                    if (result.isConfirmed) {\r\n                        try {\r\n                            const borrar_perfil = await axios.delete(`/api/perfiles/eliminar/${this.$route.params.id}`);\r\n                            if (borrar_perfil.data.success){\r\n                                this.$router.push({ name: 'Perfil', params: { id: id} });\r\n                            }else{\r\n                                Swal.fire({\r\n                                icon: 'error',\r\n                                title: 'Oops...',\r\n                                text: 'No se ha podido borrar el perfil',\r\n                            });\r\n                            }\r\n                        }catch(error){\r\n                            console.log(error)\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n        },\r\n        created() {\r\n            \r\n    }\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.home{\r\n    background: url('../assets/backgrounds/editar_perfil.png');\r\n    background-repeat: no-repeat;\r\n    background-size: 100% 100vh;\r\n}\r\n\r\n</style>","import { render } from \"./EditarPerfilView.vue?vue&type=template&id=a4f227f2&scoped=true\"\nimport script from \"./EditarPerfilView.vue?vue&type=script&lang=js\"\nexport * from \"./EditarPerfilView.vue?vue&type=script&lang=js\"\n\nimport \"./EditarPerfilView.vue?vue&type=style&index=0&id=a4f227f2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a4f227f2\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","_ctx","perfilEditando","_hoisted_6","_hoisted_7","_hoisted_8","type","placeholder","_cache","$event","$data","nombre","maxlength","_hoisted_9","src","Object","keys","length","nuevoPerfil","imagen","alt","ref","_hoisted_10","_hoisted_11","onClick","$options","seleccionarImagen","_hoisted_12","_hoisted_13","args","cancelarEdicionPerfiles","_hoisted_14","borrarPerfil","_hoisted_15","listo","data","imagenSeleccionada","mounted","storedNombre","localStorage","getItem","this","undefined","obtenerPerfilEditando","JSON","parse","id","$store","commit","lista_perfiles","imagenes","console","log","cargarDatos","async","idUsuario","$route","params","comprobarPerfil","perfiles","find","usuario","crearPerfil","computed","mapState","methods","mapMutations","mapActions","Swal","icon","title","text","$refs","editarPerfil","axios","put","success","RESETEAR_EDICION","RESETEAR_NOMBRE_PERFIL","$router","push","name","error","agregarPerfil","post","id_usuario","id_perfil","RESETEAR_NUEVO_PERFIL","setItem","removeItem","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","isConfirmed","borrar_perfil","delete","created","__exports__","render"],"sourceRoot":""}